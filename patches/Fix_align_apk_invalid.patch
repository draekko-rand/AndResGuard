From 5148a5bd7c8813bcf0fa55af00a8b851fdc7b262 Mon Sep 17 00:00:00 2001
From: "wangpengfei.threeloe" <wangpengfei.threeloe@bytedance.com>
Date: Tue, 12 Oct 2021 21:43:15 +0800
Subject: [PATCH] fix align apk invalid

---
 .../main/java/com/tencent/mm/androlib/ResourceApkBuilder.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/AndResGuard-core/src/main/java/com/tencent/mm/androlib/ResourceApkBuilder.java b/AndResGuard-core/src/main/java/com/tencent/mm/androlib/ResourceApkBuilder.java
index 20c761f..8fdcc29 100644
--- a/AndResGuard-core/src/main/java/com/tencent/mm/androlib/ResourceApkBuilder.java
+++ b/AndResGuard-core/src/main/java/com/tencent/mm/androlib/ResourceApkBuilder.java
@@ -289,7 +289,7 @@ private void alignApk(File before, File after) throws IOException, InterruptedEx
       ));
     }
     String cmd = Utils.isPresent(config.mZipalignPath) ? config.mZipalignPath : TypedValue.COMMAND_ZIPALIGIN;
-    Utils.runCmd(cmd, "4", before.getAbsolutePath(), after.getAbsolutePath());
+    Utils.runCmd(cmd,"-f","-p", "4", before.getAbsolutePath(), after.getAbsolutePath());
     if (!after.exists()) {
       throw new IOException(String.format("can not found the aligned apk file, the ZipAlign path is correct? path=%s",
           mAlignedApk.getAbsolutePath()
